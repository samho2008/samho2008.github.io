(window.webpackJsonp=window.webpackJsonp||[]).push([[189],{1983:function(a,s,t){"use strict";t.r(s);var e=t(34),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"docker-安装-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装-mysql"}},[a._v("#")]),a._v(" Docker 安装 MySQL")]),a._v(" "),t("h2",{attrs:{id:"找到合适的镜像版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#找到合适的镜像版本"}},[a._v("#")]),a._v(" 找到合适的镜像版本")]),a._v(" "),t("p",[a._v("打开 "),t("a",{attrs:{href:"https://hub.docker.com/_/mysql?tab=tags",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://hub.docker.com/_/mysql?tab=tags"),t("OutboundLink")],1),a._v(" 查询具体的版本，比如：5.7，默认会倒序排序子版本号出来。")]),a._v(" "),t("p",[a._v("然后看到有以下类型：")]),a._v(" "),t("ul",[t("li",[a._v("5.7.38-oracle")]),a._v(" "),t("li",[a._v("5.7.38")]),a._v(" "),t("li",[a._v("5.7-oracle")]),a._v(" "),t("li",[a._v("5.7")]),a._v(" "),t("li",[a._v("5.7.38-debian")]),a._v(" "),t("li",[a._v("5.7-debian")])]),a._v(" "),t("p",[a._v("说明：")]),a._v(" "),t("p",[a._v("5.7 是大版本号，38 是小版本号，由于 MySQL 官方还在不断优化更新，所以小版本还在不断更新，一般建议使用最新的小版本号，大版本号由于会有特性上的变更，所以可能会有兼容性问题。")]),a._v(" "),t("p",[a._v("MySQL 的镜像默认是针对于 Debian Linux 系统来构建的，如果是 Oracle Linux / Red Hat Enterprise Linux / CentOS Linux 需要使用带 "),t("code",[a._v("-oracle")]),a._v(" 后缀的镜像。")]),a._v(" "),t("p",[a._v("如果是 Debian Linux 系统，则选择 5.7.38 / 5.7 / 5.7.38-debian / 5.7-debian")]),a._v(" "),t("p",[a._v("如果是 Oracle Linux / Red Hat Enterprise Linux / CentOS Linux 系统，则选择 5.7.38-oracle / 5.7-oracle")]),a._v(" "),t("h2",{attrs:{id:"拉取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[a._v("#")]),a._v(" 拉取镜像")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" pull mysql:5.7.37-oracle\n")])])]),t("h2",{attrs:{id:"创建宿主机映射目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建宿主机映射目录"}},[a._v("#")]),a._v(" 创建宿主机映射目录")]),a._v(" "),t("p",[a._v("你可能需要修改以下内容：")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("MYSQL_DATA_HOME")]),a._v("：数据库在宿主机上的数据存放目录")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_DATA_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/data/mysql\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/data\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/logs\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/mysql-files\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/conf/my.cnf\n")])])]),t("h2",{attrs:{id:"创建容器-挂载数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建容器-挂载数据"}},[a._v("#")]),a._v(" 创建容器，挂载数据")]),a._v(" "),t("p",[a._v("你可能需要修改以下内容：")]),a._v(" "),t("ul",[t("li",[t("p",[t("code",[a._v("--name")]),a._v("：在 docker 中显示的容器名字，建议修改为具体的业务名，此处为 "),t("code",[a._v("dev-mysql57")])])]),a._v(" "),t("li",[t("p",[t("code",[a._v("-e TZ")]),a._v("：时区，由于默认用的时区是 UTC，北京时间为 UTC+8，所以如果不设置的话会相差八个小时。因此，需要添加 "),t("code",[a._v("-e TZ=Asia/Shanghai")])])]),a._v(" "),t("li",[t("p",[t("code",[a._v("-e MYSQL_ROOT_PASSWORD")]),a._v("：数据库 root 密码，这里以 root123456 为例子，生产环境务必使用复杂的密码！")])])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(":3306 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--name dev-mysql57 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/data:/var/lib/mysql "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/logs:/var/log/mysql "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/conf:/etc/mysql/conf.d "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$MYSQL_DATA_HOME")]),a._v("/mysql-files:/var/lib/mysql-files "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("root123456 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("TZ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Asia/Shanghai "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("always "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-d mysql:5.7.37-oracle "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--character-set-server"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8mb4 --collation-server"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8mb4_general_ci "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--lower-case-table-names"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("参考文献：")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/60259783b525",target:"_blank",rel:"noopener noreferrer"}},[a._v("docker中MySQL的时区修改"),t("OutboundLink")],1)]),a._v(" "),t("p",[t("a",{attrs:{href:"docker%E4%B8%ADmysql%E5%A4%A7%E5%B0%8F%E5%86%99%E9%97%AE%E9%A2%98%E8%AE%BE%E7%BD%AE"}},[a._v("https://blog.csdn.net/weixin_45357522/article/details/115045401")])])]),a._v(" "),t("h2",{attrs:{id:"启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[a._v("#")]),a._v(" 启动容器")]),a._v(" "),t("p",[a._v("如果服务没有启动运行，但是容器是存在的，可以通过 "),t("code",[a._v("start")]),a._v(" 启动已存在的容器。")]),a._v(" "),t("p",[a._v("注意：这里的 "),t("code",[a._v("dev-mysql57")]),a._v(" 要和上面创建容器时指定的 "),t("code",[a._v("--name")]),a._v(" 保持一致。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" start dev-mysql57\n")])])]),t("h2",{attrs:{id:"查看容器是否启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器是否启动"}},[a._v("#")]),a._v(" 查看容器是否启动")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("看到以下内容说明启动成功：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# docker ps")]),a._v("\nCONTAINER ID   IMAGE                 COMMAND                  CREATED          STATUS          PORTS                                                  NAMES\n0526fb1b2374   mysql:5.7.37-oracle   "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"docker-entrypoint.s…"')]),a._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("13")]),a._v(" seconds ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(" seconds   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),a._v(".0.0:3306-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("/tcp, :::3306-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("33060")]),a._v("/tcp   dev-mysql57\n")])])])]),a._v(" "),t("h2",{attrs:{id:"放行端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#放行端口"}},[a._v("#")]),a._v(" 放行端口")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("firewall-cmd --zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("/tcp --permanent\nfirewall-cmd --reload\n")])])]),t("h2",{attrs:{id:"进入容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进入容器"}},[a._v("#")]),a._v(" 进入容器")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -it mysql /bin/bash\n")])])]),t("h2",{attrs:{id:"查看日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看日志"}},[a._v("#")]),a._v(" 查看日志")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" logs mysql\n")])])]),t("blockquote",[t("p",[a._v("参考文献：")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/weixin_40461281/article/details/92610876",target:"_blank",rel:"noopener noreferrer"}},[a._v("docker 安装 Mysql 5.7"),t("OutboundLink")],1)]),a._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/hgyu/article/details/86492598",target:"_blank",rel:"noopener noreferrer"}},[a._v("mysql docker 中配置日志文件挂载到本地目录"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);