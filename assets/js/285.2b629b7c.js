(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{2166:function(t,e,s){"use strict";s.r(e);var r=s(34),a=Object(r.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"nginx-conf-配置文件模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-conf-配置文件模板"}},[t._v("#")]),t._v(" Nginx conf 配置文件模板")]),t._v(" "),s("h2",{attrs:{id:"http-转-https"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-转-https"}},[t._v("#")]),t._v(" http 转 https")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("server\n{\n    #HTTP_TO_HTTPS_START\n    if ($server_port !~ 443){\n        rewrite ^(/.*)$ https://$host$1 permanent;\n    }\n    #HTTP_TO_HTTPS_END\n}\n")])])]),s("h2",{attrs:{id:"部署-https-证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署-https-证书"}},[t._v("#")]),t._v(" 部署 https 证书")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('server\n{\n\tlisten 443 ssl http2;\n\n    ssl_certificate    /www/server/panel/vhost/cert/your.domain.com/fullchain.pem;\n    ssl_certificate_key    /www/server/panel/vhost/cert/your.domain.com/privkey.pem;\n    ssl_protocols TLSv1.1 TLSv1.2 TLSv1.3;\n    ssl_ciphers EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;\n    ssl_prefer_server_ciphers on;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n    add_header Strict-Transport-Security "max-age=31536000";\n    error_page 497  https://$host$request_uri;\n}\n')])])]),s("h2",{attrs:{id:"安全策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安全策略"}},[t._v("#")]),t._v(" 安全策略")]),t._v(" "),s("h3",{attrs:{id:"禁止爬虫工具访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#禁止爬虫工具访问"}},[t._v("#")]),t._v(" 禁止爬虫工具访问")]),t._v(" "),s("p",[t._v("Nginx 配置文件中的 server 层加入以下内容：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('# 禁止 Scrapy 等爬虫工具的抓取\nif ($http_user_agent ~* "Scrapy|Sogou web spider|Baiduspider") {\n  return 403;\n}\n')])])]),s("h3",{attrs:{id:"禁止指定-ua-的访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#禁止指定-ua-的访问"}},[t._v("#")]),t._v(" 禁止指定 UA 的访问")]),t._v(" "),s("p",[t._v("Nginx 配置文件中的 server 层加入以下内容：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('#禁止指定UA及UA为空的访问\nif ($http_user_agent ~ "FeedDemon|JikeSpider|Indy Library|Alexa Toolbar|AskTbFXTV|AhrefsBot|CrawlDaddy|CoolpadWebkit|Java|Feedly|UniversalFeedParser|ApacheBench|Microsoft URL Control|Swiftbot|ZmEu|oBot|jaunty|Python-urllib|lightDeckReports Bot|YYSpider|DigExt|YisouSpider|HttpClient|MJ12bot|heritrix|EasouSpider|LinkpadBot|Ezooms|^$" ) {\n  return 403;\n}\n')])])]),s("h3",{attrs:{id:"禁止非-get-head-post-方式的抓取"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#禁止非-get-head-post-方式的抓取"}},[t._v("#")]),t._v(" 禁止非 GET|HEAD|POST 方式的抓取")]),t._v(" "),s("p",[t._v("Nginx 配置文件中的 server 层加入以下内容：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# 禁止非 GET|HEAD|POST 方式的抓取\nif ($request_method !~ ^(GET|HEAD|POST)$) {\n  return 403;\n}\n")])])]),s("blockquote",[s("p",[t._v("参考文献：")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/wjoyxt/p/6178458.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("利用nginx来屏蔽指定的user_agent的访问以及根据user_agent做跳转"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=a.exports}}]);