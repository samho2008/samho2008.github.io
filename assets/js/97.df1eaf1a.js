(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{2043:function(t,a,s){"use strict";s.r(a);var e=s(34),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"安装-gitlab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装-gitlab"}},[t._v("#")]),t._v(" 安装 GitLab")]),t._v(" "),e("p",[t._v("极狐 GitLab "),e("a",{attrs:{href:"https://gitlab.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitlab.cn/"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("由于 GitLab 官方的最新政策，中国大陆地区的自部署 GitLab 需要将原 EE Edition 变更为其中国合作伙伴"),e("strong",[t._v("极狐 GitLab")]),t._v("：")]),t._v(" "),e("blockquote",[e("p",[t._v("There will be three distributions of the GitLab product: CE (Community Edition), EE (Enterprise Edition), and JH (JiHu Edition). The CE distribution will continue to be available globally. The EE distribution will only be sold outside China. The JH distribution will only be sold in China.")])]),t._v(" "),e("p",[e("strong",[t._v("此次许可变更对原有功能没有影响。")])]),t._v(" "),e("blockquote",[e("p",[t._v("参考文献：")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://sci.nju.edu.cn/8e/3c/c30384a560700/page.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("Box 打包支持到10个G、Git 版本变更"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"gitlab-服务器配置要求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-服务器配置要求"}},[t._v("#")]),t._v(" GitLab 服务器配置要求")]),t._v(" "),e("p",[t._v("CPU 建议至少 4 核。官方说明："),e("a",{attrs:{href:"https://docs.gitlab.com/ee/install/requirements.html#cpu",target:"_blank",rel:"noopener noreferrer"}},[t._v("CPU配置"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("内存建议至少要 4G，建议添加 2G 虚拟内存，并设置 kernel’s swappiness 为 10。官方说明："),e("a",{attrs:{href:"https://docs.gitlab.com/ee/install/requirements.html#memory",target:"_blank",rel:"noopener noreferrer"}},[t._v("内存配置"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("2022年 4 月 25 日安装 GitLab 版本 14.10，内存占用情况：")]),t._v(" "),e("p",[t._v("本地测试，最小化安装 CentOS 7 1804，只安装了 GitLab 服务。")]),t._v(" "),e("p",[e("strong",[t._v("GitLab 相对其他环境来说挺吃配置的，内存建议至少 8G 以上，越大越好！")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# free -h")]),t._v("\n              total        used        "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v("      shared  buff/cache   available\nMem:           "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".8G        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".5G         68M         23M        212M         60M\nSwap:          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(".0G        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(".0G         41M\n")])])]),e("h2",{attrs:{id:"通过上传安装包安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#通过上传安装包安装"}},[t._v("#")]),t._v(" 通过上传安装包安装")]),t._v(" "),e("p",[t._v("打开清华大学镜像站："),e("a",{attrs:{href:"https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("找到【gitlab-ce-12.9.2-ce.0.el7.x86_64.rpm】这个版本，然后点击下载到本机上。")]),t._v(" "),e("p",[t._v("1、安装 GitLab 服务所依赖的包")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" policycoreutils-python openssh-server postfix "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v("\n")])])]),e("p",[t._v("2、安装 GitLab 服务")]),t._v(" "),e("p",[e("strong",[t._v("注意：由于使用的是本地安装，需要把下载好的安装包上传到服务器上！")])]),t._v(" "),e("p",[t._v("【gitlab-ce-12.9.2-ce.0.el7.x86_64.rpm】对应的是下载的安装包名字，根据实际情况修改。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum localinstall -y gitlab-ce-12.9.2-ce.0.el7.x86_64.rpm\n")])])]),e("p",[t._v("3、配置 GitLab 服务，访问域名以及邮箱")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/gitlab/gitlab.rb\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改访问地址，IP 就配置 IP，域名就配置域名，域名也可以通过修改本地 hosts 文件。")]),t._v("\nexternal_url "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://gitlab.yuanke.com'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置邮箱（默认加了注释符 # 记得去掉）")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以搜索【### Email Settings】来找")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用邮箱")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gitlab_email_enabled'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发送邮箱，把邮箱修改成你要发送的邮箱，要和下面的 smtp_user_name 保持一致")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gitlab_email_from'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'530979104@qq.com'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发件人名称，显示在邮件中")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gitlab_email_display_name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yuanke-gitlab'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 配置（默认加了注释符 # 记得去掉）")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以搜索【### GitLab email server settings】来找")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用 smtp 服务")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_enable'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 地址")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_address'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"smtp.qq.com"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 端口号")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_port'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("465")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 账号，和上面的 gitlab_email_from 保持一致")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_user_name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"530979104@qq.com"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 密码")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_password'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hqvzmkwywndwbiah"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 域名")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_domain'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qq.com"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# smtp 认证方式")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_authentication'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 自动开启 tls")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_enable_starttls_auto'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用 tls（默认 false，需要手动改成 true）")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_tls'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭 smtp 验证 openssl 模式")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认前面有个注释符 # 去掉即可")]),t._v("\ngitlab_rails"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_openssl_verify_mode'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),t._v("\n")])])]),e("p",[t._v("初始化 GitLab 配置")]),t._v(" "),e("p",[e("strong",[t._v("注意：初始化这个步骤要等很久，可以先去配置下面的 hosts 文件。")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("gitlab-ctl reconfigure\ngitlab-ctl status\n")])])]),e("blockquote",[e("p",[t._v("配置完成后，默认会启动 GitLab 服务，可以使用 "),e("code",[t._v("gitlab-ctl status")]),t._v(" 查看状态。")]),t._v(" "),e("p",[t._v("如果没有启动，也可以通过 "),e("code",[t._v("gitlab-ctl start")]),t._v(" 手动启动，通过 "),e("code",[t._v("gitlab-ctl restart")]),t._v(" 重启。")]),t._v(" "),e("p",[t._v("gitlab-ctl stop 停止 GitLab 服务。")])]),t._v(" "),e("p",[t._v("访问 GitLab 以及测试 GitLab 邮箱。")]),t._v(" "),e("p",[t._v("修改本机 hosts 文件（C:\\Windows\\System32\\drivers\\etc\\hosts），做映射处理。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("10.1.0.201 gitlab.yuanke.com\n")])])]),e("p",[t._v("开启防火墙 80 端口")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("firewall-cmd --add-port=80/tcp --permanent\nfirewall-cmd --reload\n")])])]),e("p",[t._v("浏览器访问页面："),e("a",{attrs:{href:"gitlab.yuanke.com"}},[t._v("gitlab.yuanke.com")])]),t._v(" "),e("p",[t._v("第一次打开的时候，需要设置管理员密码（需要八位数以上）。")]),t._v(" "),e("p",[t._v("注意：如果一直提示密码有问题，可以开启【无痕模式】再试试。")]),t._v(" "),e("p",[t._v("密码：root123456")]),t._v(" "),e("blockquote",[e("p",[t._v("密码规则：")]),t._v(" "),e("h2",{attrs:{id:"_8-errors-prohibited-this-user-from-being-saved"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-errors-prohibited-this-user-from-being-saved"}},[t._v("#")]),t._v(" 8 errors prohibited this user from being saved:")]),t._v(" "),e("ul",[e("li",[t._v("Email can't be blank")]),t._v(" "),e("li",[t._v("Password can't be blank")]),t._v(" "),e("li",[t._v("Namespace route can't be blank")]),t._v(" "),e("li",[t._v("Namespace name can't be blank")]),t._v(" "),e("li",[t._v("Name can't be blank")]),t._v(" "),e("li",[t._v("Notification email can't be blank")]),t._v(" "),e("li",[t._v("Username can't be blank")]),t._v(" "),e("li",[t._v("Username can contain only letters, digits, '_', '-' and '.'. Cannot start with '-' or end in '.', '.git' or '.atom'.")])])]),t._v(" "),e("p",[t._v("用户名默认是：root")]),t._v(" "),e("p",[t._v("密码是刚才设置的密码：root123456")]),t._v(" "),e("blockquote",[e("p",[t._v("参考文献：")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://www.bilibili.com/video/BV1V64y1e7VQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("【云知梦】企业级私库Gitlab入门和实战_哔哩哔哩_bilibili"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://blog.csdn.net/gnail_oug/article/details/96701397",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitlab配置SMTP方式发送邮件_gnail_oug的博客-CSDN博客_gitlab smtp"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"通过-rpm-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#通过-rpm-安装"}},[t._v("#")]),t._v(" 通过 RPM 安装")]),t._v(" "),e("p",[t._v("打开 GitLab 官网："),e("a",{attrs:{href:"https://about.gitlab.com/install/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://about.gitlab.com/install/"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("向下翻找到不同系统的安装方法，如图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:s(939),alt:"image-20220425043835591"}})]),t._v(" "),e("p",[t._v("这里以 CentOS 7 为例。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(940),alt:"image-20220425043927638"}})]),t._v(" "),e("p",[t._v("具体命令如下")]),t._v(" "),e("h3",{attrs:{id:"安装必要的依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装必要的依赖"}},[t._v("#")]),t._v(" 安装必要的依赖")]),t._v(" "),e("p",[t._v("在 CentOS 7（以及 RedHat/Oracle/Scientific Linux 7），以下命令会同时开启 HTTP, HTTPS 和 SSH 在防火墙中的访问。")]),t._v(" "),e("p",[t._v("如果你只想在局域网内部使用，这步是可选的。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" policycoreutils-python openssh-server perl\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enable OpenSSH server daemon if not enabled: sudo systemctl status sshd")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" sshd\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start sshd\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Check if opening the firewall is needed with: sudo systemctl status firewalld")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" firewall-cmd --permanent --add-service"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" firewall-cmd --permanent --add-service"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl reload firewalld\n")])])]),e("p",[t._v("接下来，安装 Postfix 来发送邮件。如果你想使用另外一种方案来发送邮件，可以跳过这个步骤，然后在安装完成 GitLab 以后配置外部的 SMTP 服务器来发送邮件。")]),t._v(" "),e("p",[t._v("配置外部 SMTP 服务器："),e("a",{attrs:{href:"https://docs.gitlab.com/omnibus/settings/smtp.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.gitlab.com/omnibus/settings/smtp.html"),e("OutboundLink")],1)]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" postfix\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" postfix\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start postfix\n")])])]),e("blockquote",[e("p",[t._v("在安装的过程中会出现 "),e("code",[t._v("Is this ok [y/d/N]: y")]),t._v("，输入 y 确认安装即可。")])]),t._v(" "),e("h3",{attrs:{id:"添加-gitlab-包仓库和安装-gitlab-包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加-gitlab-包仓库和安装-gitlab-包"}},[t._v("#")]),t._v(" 添加 GitLab 包仓库和安装 GitLab 包")]),t._v(" "),e("p",[t._v("添加 GitLab 包仓库")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),e("p",[t._v("接下来，安装 GitLab 包。确保你已经配置好 DNS 域名，配置网址："),e("a",{attrs:{href:"https://docs.gitlab.com/omnibus/settings/dns.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.gitlab.com/omnibus/settings/dns.html"),e("OutboundLink")],1),t._v("，然后把 "),e("code",[t._v("https://gitlab.example.com")]),t._v(" 改成你访问 GitLab 的地址。安装包会自动配置然后使用这个地址来启动 GitLab。")]),t._v(" "),e("p",[t._v("如果使用 "),e("code",[t._v("https://")]),t._v("，GitLab 会自动"),e("a",{attrs:{href:"https://docs.gitlab.com/omnibus/settings/ssl.html#lets-encrypthttpsletsencryptorg-integration",target:"_blank",rel:"noopener noreferrer"}},[t._v("要求 Let's Encrypt 证书"),e("OutboundLink")],1),t._v("，这要求绑定好 DNS 域名。你也可以使用自己的证书或者直接使用 "),e("code",[t._v("http://")]),t._v(" （没有 "),e("code",[t._v("s")]),t._v("）。")]),t._v(" "),e("p",[t._v("如果你想自定义一个密码作为初始的管理员用户 "),e("code",[t._v("root")]),t._v(" 的密码，参考文档："),e("a",{attrs:{href:"https://docs.gitlab.com/omnibus/installation/index.html#set-up-the-initial-password",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.gitlab.com/omnibus/installation/index.html#set-up-the-initial-password"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("如果没有指定密码，会随机生成一个密码。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意：需要把 https://gitlab.example.com 换成服务器的 IP/域名")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 比如，服务器 IP 地址为 192.168.202.251")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把 https://gitlab.example.com 换成 http://192.168.202.251")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意，http 和 https 的区别！")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EXTERNAL_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://gitlab.example.com"')]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y gitlab-ee\n")])])]),e("h3",{attrs:{id:"登录-gitlab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#登录-gitlab"}},[t._v("#")]),t._v(" 登录 GitLab")]),t._v(" "),e("p",[t._v("打开 GitLab 网址（和安装时设置的 EXTERNAL_URL 一样）：http://192.168.202.251/")]),t._v(" "),e("p",[t._v("除非在安装的时候提供了一个自定义的密码，否则会随机产生一个密码，存放在 "),e("code",[t._v("/etc/gitlab/initial_root_password")]),t._v("。把这个作为用户名 "),e("code",[t._v("root")]),t._v(" 密码去登陆。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /etc/gitlab/initial_root_password\n")])])]),e("blockquote",[e("p",[t._v("这个文件在 24 小时之后会自动删除，所以需要及时记下 GitLab 的 root 密码！")])]),t._v(" "),e("p",[e("img",{attrs:{src:s(941),alt:"image-20220425051603243"}})]),t._v(" "),e("h3",{attrs:{id:"设置邮箱接收-gitlab-官方的通知-可选"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置邮箱接收-gitlab-官方的通知-可选"}},[t._v("#")]),t._v(" 设置邮箱接收 GitLab 官方的通知（可选）")]),t._v(" "),e("p",[t._v("通过 "),e("a",{attrs:{href:"https://about.gitlab.com/company/preference-center/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://about.gitlab.com/company/preference-center/"),e("OutboundLink")],1),t._v(" 订阅 GitLab 官方通知，当 GitLab 更新了新的特性、文档，或者一些更新、漏洞的时候会自动发邮件通知你。")]),t._v(" "),e("h3",{attrs:{id:"安装完成之后的推荐步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装完成之后的推荐步骤"}},[t._v("#")]),t._v(" 安装完成之后的推荐步骤")]),t._v(" "),e("p",[t._v("在完成 GitLab 的安装之后，可以参考 "),e("a",{attrs:{href:"https://docs.gitlab.com/ee/install/next_steps.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.gitlab.com/ee/install/next_steps.html"),e("OutboundLink")],1),t._v(" 考虑进一步配置安全设置和注册限制。")]),t._v(" "),e("h3",{attrs:{id:"关闭-gitlab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关闭-gitlab"}},[t._v("#")]),t._v(" 关闭 GitLab")]),t._v(" "),e("p",[t._v("使用 "),e("code",[t._v("gitlab-ctl")]),t._v(" 管理 GitLab。")]),t._v(" "),e("p",[t._v("关闭命令如下：")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("gitlab-ctl stop\n")])])]),e("p",[t._v("执行日志：")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gitlab-ctl stop")]),t._v("\nok: down: alertmanager: 1s, normally up\nok: down: gitaly: 0s, normally up\nok: down: gitlab-exporter: 1s, normally up\nok: down: gitlab-kas: 0s, normally up\nok: down: gitlab-workhorse: 1s, normally up\nok: down: grafana: 0s, normally up\nok: down: logrotate: 1s, normally up\nok: down: nginx: 0s, normally up\nok: down: node-exporter: 0s, normally up\nok: down: postgres-exporter: 1s, normally up\nok: down: postgresql: 0s, normally up\nok: down: prometheus: 1s, normally up\nok: down: puma: 0s, normally up\nok: down: redis: 0s, normally up\nok: down: redis-exporter: 0s, normally up\nok: down: sidekiq: 0s, normally up\n")])])]),e("h3",{attrs:{id:"启动-gitlab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动-gitlab"}},[t._v("#")]),t._v(" 启动 GitLab")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gitlab-ctl start\n")])])]),e("h3",{attrs:{id:"重启-gitlab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重启-gitlab"}},[t._v("#")]),t._v(" 重启 GitLab")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gitlab-ctl restart\n")])])]),e("h2",{attrs:{id:"通过-docker-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#通过-docker-安装"}},[t._v("#")]),t._v(" 通过 Docker 安装")]),t._v(" "),e("h2",{attrs:{id:"通过宝塔面板安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#通过宝塔面板安装"}},[t._v("#")]),t._v(" 通过宝塔面板安装")]),t._v(" "),e("blockquote",[e("p",[t._v("参考资料：")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://blog.csdn.net/tengqingyong/article/details/109494991",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitlab启动、停止、重启"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports},939:function(t,a,s){t.exports=s.p+"assets/img/image-20220425043835591.da205e0c.png"},940:function(t,a,s){t.exports=s.p+"assets/img/image-20220425043927638.b21974ea.png"},941:function(t,a,s){t.exports=s.p+"assets/img/image-20220425051603243.ed29b3e6.png"}}]);